<ion-header>
  <ion-toolbar>
    <ion-title>Computer Parts</ion-title>
  </ion-toolbar>

  <!-- Category Filter - Desktop (Segment) -->
  <ion-toolbar class="desktop-filter">
    <ion-segment 
      [value]="selectedCategory" 
      (ionChange)="onCategoryChange($event)"
      scrollable="true"
      mode="md"
    >
      <ion-segment-button 
        *ngFor="let cat of categories" 
        [value]="cat.value"
      >
        <ion-label>{{ cat.label }}</ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>

  <!-- Category Filter - Mobile (Dropdown) -->
  <ion-toolbar class="mobile-filter">
    <ion-select
      [(ngModel)]="selectedCategory"
      (ionChange)="onCategoryChange($event)"
      interface="popover"
      placeholder="Select Category"
      class="category-select"
    >
      <ion-select-option 
        *ngFor="let cat of categories" 
        [value]="cat.value"
      >
        {{ cat.label }}
      </ion-select-option>
    </ion-select>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="parts-container">
    <!-- Parts Section -->
    <section class="parts-section" *ngIf="loading || parts.length > 0">
      <div class="section-header">
        <h2>{{ selectedCategory === 'all' ? 'All Computer Parts' : getCategoryLabel(selectedCategory) }}</h2>
        <ion-icon name="hardware-chip" color="primary"></ion-icon>
      </div>

      <!-- Loading Skeleton -->
      <app-skeleton-loader *ngIf="loading" variant="part-card" [count]="6"></app-skeleton-loader>

      <!-- Parts Grid -->
      <div *ngIf="!loading" class="parts-grid">
    <ion-card 
      *ngFor="let part of parts" 
      class="part-card"
      [routerLink]="['/parts', part.slug]"
      button
    >
      <img 
        [src]="part.image_url || 'assets/images/placeholder-part.svg'" 
        [alt]="part.name"
        class="part-image"
      />
      
      <ion-card-header>
        <ion-chip class="category-chip">
          <ion-label>{{ getCategoryLabel(part.category) }}</ion-label>
        </ion-chip>
        <ion-card-title>{{ part.name }}</ion-card-title>
      </ion-card-header>
      
      <ion-card-content>
        <p class="part-description">{{ part.description }}</p>
        
        <div class="specs-preview" *ngIf="part.specifications">
          <ion-icon name="hardware-chip-outline"></ion-icon>
          <span>{{ getSpecsCount(part.specifications) }} specs</span>
        </div>
      </ion-card-content>
    </ion-card>
      </div>
    </section>

    <!-- Empty State -->
    <div *ngIf="!loading && parts.length === 0" class="empty-state">
      <ion-icon name="cube-outline" size="large"></ion-icon>
      <h3>No Parts Found</h3>
      <p>Try selecting a different category</p>
    </div>
  </div>

  <!-- Infinite Scroll -->
  <ion-infinite-scroll 
    *ngIf="!loading && hasMore"
    (ionInfinite)="loadMore($event)"
    threshold="100px"
  >
    <ion-infinite-scroll-content
      loadingSpinner="crescent"
      loadingText="Loading more parts..."
    ></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>
