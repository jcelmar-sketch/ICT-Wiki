<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/admin/login" text="Back to Login"></ion-back-button>
    </ion-buttons>
    <ion-title>Reset Password</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="forgot-password-content">
  <div class="forgot-password-container">
    <!-- Header -->
    <div class="page-header">
      <ion-icon name="mail-outline" class="page-icon"></ion-icon>
      <h1>Forgot Password?</h1>
      <p class="subtitle" *ngIf="!submitted">
        Enter your admin email address and we'll send you instructions to reset your password.
      </p>
    </div>

    <!-- Success Message -->
    <ion-card *ngIf="submitted && successMessage" class="success-alert" color="success">
      <ion-card-content>
        <ion-icon name="checkmark-circle" slot="start"></ion-icon>
        <div>
          <strong>Email Sent!</strong>
          <p>{{ successMessage }}</p>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Form -->
    <form 
      *ngIf="!submitted" 
      [formGroup]="forgotPasswordForm" 
      (ngSubmit)="onSubmit()" 
      class="forgot-password-form"
    >
      <!-- Error Alert -->
      <ion-card *ngIf="errorMessage" class="error-alert" color="danger">
        <ion-card-content>
          <ion-icon name="alert-circle" slot="start"></ion-icon>
          <span>{{ errorMessage }}</span>
        </ion-card-content>
      </ion-card>

      <!-- Email Field -->
      <ion-item lines="full" [class.ion-invalid]="hasError('email', 'required') || hasError('email', 'email')">
        <ion-label position="floating">Admin Email</ion-label>
        <ion-input
          type="email"
          formControlName="email"
          placeholder="admin@example.com"
          autocomplete="email"
          [clearInput]="true"
          aria-label="Admin email address"
          aria-required="true"
        ></ion-input>
        <ion-note slot="error" *ngIf="hasError('email', 'required')">
          Email is required
        </ion-note>
        <ion-note slot="error" *ngIf="hasError('email', 'email')">
          Please enter a valid email
        </ion-note>
      </ion-item>

      <!-- Submit Button -->
      <ion-button
        expand="block"
        type="submit"
        [disabled]="loading"
        class="submit-button"
        aria-label="Send password reset email"
      >
        <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
        <span *ngIf="!loading">Send Reset Instructions</span>
      </ion-button>
    </form>

    <!-- Back to Login Button (shown after submission) -->
    <ion-button
      *ngIf="submitted"
      expand="block"
      fill="outline"
      (click)="goToLogin()"
      class="back-button"
    >
      <ion-icon name="arrow-back" slot="start"></ion-icon>
      Back to Login
    </ion-button>

    <!-- Info Note -->
    <div class="info-note">
      <ion-icon name="information-circle-outline"></ion-icon>
      <p>
        <strong>Note:</strong> Password reset links are valid for 1 hour. 
        If you don't receive an email, check your spam folder or contact your system administrator.
      </p>
    </div>
  </div>
</ion-content>
